WITH FUNCTIONS_CTE (ID, X, Y) AS ( SELECT ROW_NUMBER() OVER(ORDER BY X), X, Y FROM FUNCTIONS) SELECT DISTINCT F1.X, F1.Y FROM FUNCTIONS_CTE F1 INNER JOIN FUNCTIONS_CTE F2 ON F1.X = F2.Y AND F2.X = F1.Y AND F1.ID != F2.ID WHERE F1.X <= F1.Y ORDER BY F1.X
